getwd()
\documentclass{article}
setwd("~/GitHub/radcliffe/radmeeting")
obsclim<-read.csv("obsclim.csv", header=T)
expclim<-read.csv("expclim.csv", header=T)
exppheno<-read.csv("exppheno.csv", header=T)
obspheno<-read.csv("obspheno.csv", header=T)
head(expclim)
obsmat<-aggregate(x=subset(obsclim, select=c("tmean")), by=list(obsclim$year,obsclim$site), FUN=mean, na.rm=T)
head(obsmat)
dim(obsclim)
head(obspheno)
unieu(obspheno$site)
uniqeu(obspheno$site)
unique(obspheno$site)
colnames(obsmat)[1:2]<-c("year","site")
obsmat_subset<-obsmat[which(obsmat$site=="fitter"|obsmat$site=="harvard"|obsmat$site=="hubbard"|obsmat$site=="konza"|obsmat$site=="niwot"|obsmat$site=="mikesell"|obsmat$site=="concord"|obsmat$site=="mohonk"|obsmat$site=="marsham"|obsmat$site=="fargo"|obsmat$site=="washdc"|obsmat$site=="bolmgren"|obsmat$site=="gothic"|obsmat$site=="uwm"|obsmat$site=="rousi",)
]
colnames(obsmat)[1:2]<-c("year","site")
head(obsmat)
obsmat_subset<-obsmat[which(obsmat$site=="fitter"|obsmat$site=="harvard"|obsmat$site=="hubbard"|obsmat$site=="konza"|obsmat$site=="niwot"|obsmat$site=="mikesell"|obsmat$site=="concord"|obsmat$site=="mohonk"|obsmat$site=="marsham"|obsmat$site=="fargo"|obsmat$site=="washdc"|obsmat$site=="bolmgren"|obsmat$site=="gothic"|obsmat$site=="uwm"|obsmat$site=="rousi"),]
dim(obsmat)
dim(obsclim)
dim(obsmat_subset)
obsdat<-merge(obsmat_subset,obspheno)
dim(obsdat)
head(obsdat)
obsdat$spgen<-paste(obsdat$genus,obsdat$species,sep=".")
install.packages("lme4")
install.packages("reshape")
library(lme4)
obs.mod<-lmer(doy ~ MAT + (1|site/species), data=obsdat)
obs.mod<-lmer(doy ~ tmean + (1|site/species), data=obsdat)
summary(obs.mod)
summary(obs.mod)
ranef(obs.mod)
obs.mod<-lmer(doy ~ tmean + (1|site/spgen), data=obsdat)
summary(obs.mod)
head(expclim)
expmat<-aggregate(x=subset(explim, select=c("soiltemp1_mean")), by=list(expclim$year,obsclim$site,expclim$plot,), FUN=mean, na.rm=T)
expmat<-aggregate(x=subset(expclim, select=c("soiltemp1_mean")), by=list(expclim$year,expclim$site,expclim$plot,), FUN=mean, na.rm=T)
expmat<-aggregate(x=subset(expclim, select=c("soiltemp1_mean"), by=list(expclim$year,expclim$site,expclim$plot,), FUN=mean, na.rm=T)
expmat<-aggregate(x=subset(expclim, select=c("soiltemp1_mean")), by=list(expclim$year,expclim$site,expclim$plot), FUN=mean, na.rm=T)
head(expmat)
colnames(expmat)[1:2]<-c("year","site","plot")
colnames(expmat)[1:3]<-c("year","site","plot")
expdat<-merge(expmat,exppheno)
dim(expmat)
expdat$spgen<-paste(expdat$genus,expdat$species,sep=".")
exp.mod<-lmer(doy ~ tmean + (1|site/spgen), data=expdat)
exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=expdat)
summary(exp.mod)
fixef(obs.mod)
plot(1,fixef(obs.mod)[2],type="p", pch=10,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=16,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=1,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=2,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=3,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=4,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=5,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=6,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=7,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=8,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=9,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=10,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=11,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=12,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=13,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=14,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=14,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=15,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,bty="l",ylab="Sensitivity (change days per C)")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,bty="l",ylab="Sensitivity (change days per C)", xaxt="n")
points(2,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,col="darkred")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(1,2))
points(2,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,col="darkred")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(1,2), ylim=c(0,-8))
points(2,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,col="darkred")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(0,3), ylim=c(0,-8))
points(2,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,col="darkred")
plot(1,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
points(2,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,col="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.2,bg="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=26, cex=1.2,col="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=23, cex=1.2,col="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=22, cex=1.2,col="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=21, cex=1.2,col="darkred")
points(1,fixef(exp.mod)[2],type="p", pch=21, cex=1.2,fill="darkred")
plot(2,fixef(obs.mod)[2],type="p", pch=15,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
points(1,fixef(exp.mod)[2],type="p", pch=21, cex=1.2,bg="darkred")
col
plot(2,fixef(obs.mod)[2],type="p", pch=21,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
plot(2,fixef(obs.mod)[2],type="p", pch=20,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.2,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topright",legend=c("Experiments","Observations"), pch=c(16,22),col=c("darkred","blue"))
legend("topleft",legend=c("Experiments","Observations"), pch=c(16,22),col=c("darkred","blue"))
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(0,-8))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-8,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
abline(h=0)
abline(h=0, lty=2)
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-8,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-8,5))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-8,2))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
install.packages("SweaveListingUtils")
summary(obs.mod)
arrows(1,fixef(exp.mod)[2]+0.0572,1,fixef(exp.mod)[2]-0.0572,length=.1,angle=45,col="blue",code=1,lwd=2)
arrows(1,fixef(exp.mod)[2]+0.0572,1,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
arrows(2,fixef(exp.mod)[2]+0.0572,1,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
arrows(,fixef(exp.mod)[2]+0.0572,2,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
arrows(2,fixef(exp.mod)[2]+0.0572,2,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
summary(exp.mod)
arrows(2,fixef(exp.mod)[2]+0.0572,2,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
summary(exp.mod)
arrows(2,fixef(exp.mod)[2]+0.0572,2,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
exp.mod)[2]
fixef(exp.mod)[2]
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-8,2))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,fixef(exp.mod)[2]+0.0572,1,fixef(exp.mod)[2]-0.0572,length=.1,angle=90,col="darkred",code=1,lwd=2)
arrows(2,fixef(obs.mod)[2]+0.0572,2,fixef(obs.mod)[2]-0.0572,length=.1,angle=90,col="blue",code=1,lwd=2)
confint(exp.mod)
arrows(1,-2.249826+0.0572,1,-1.973586,length=.1,angle=90,col="darkred",code=1,lwd=2)
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-2.249826+0.0572,1,-1.973586,length=.1,angle=90,col="darkred",code=1,lwd=2)
arrows(1,-1.973586,1,-2.249826+0.0572,length=.1,angle=90,col="darkred",code=1,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
arrows(1,-1.973586,1,-2.249826+0.0572,length=.1,angle=90,col="darkred",code=1,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826+0.0572,length=.05,angle=90,col="darkred",code=1,lwd=2)
arrows(1,-1.973586,1,-2.249826+0.0572,length=.05,angle=90,col="darkred",code=2,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826+0.0572,length=.05,angle=90,col="darkred",code=2,lwd=2)
arrows(1,-1.973586,1,-2.249826+0.0572,length=.05,angle=90,col="darkred",code=3,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend("topleft",legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826+0.0572,length=.05,angle=90,col="darkred",code=3,lwd=2)
fixef(exp.mod)[2]
confint(obs.mod)
legend(c(-1,.5),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend(c(-1,.5),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=1,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend(c(-1,.5),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=3,lwd=2)
legend(c(-1,0),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
legend(c(-1,.5),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend(c(-1,.5),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=3,lwd=2)
legend(c(.5,-1),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend(c(.5,-2),legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=3,lwd=2)
legend(.5,-2,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
legend(.5,-1,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.5,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.5,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=3,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.1,angle=90,col="blue",code=3,lwd=2)
quartz()
plot(2,fixef(obs.mod)[2],type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1,fixef(exp.mod)[2],type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1,-1.973586,1,-2.249826,length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(2,-7.177654,2,-6.953411,length=.05,angle=90,col="blue",code=3,lwd=2)
head(expdat)
leaf.expdat<-data[expdat$event=="lod",]
leaf.expdat<-data[which(expdat$event=="lod"),]
leaf.expdat<-expdat[expdat$event=="lod",]
dim(leaf.expdat)
dim(expdat)
leaf.obsdat<-obsdat[obsdat$event=="lod",]
dim(obsdat)
dim(leaf.obsdat)
unqie(obsdat$event)
unique(obsdat$event)
leaf.obsdat<-obsdat[obsdat$event=="lod"|obsdat$event=="bbd",]
leaf.expdat<-expdat[expdat$event=="lod"|expdat$event=="bbd",]
dim(leaf.obsdat)
dim(leaf.expdat)
leaf.expdat<-expdat[expdat$event=="lod"|expdat$event=="bbd"|expdat$event=="lud",]
leaf.obsdat<-obsdat[obsdat$event=="lod"|obsdat$event=="bbd"|obsdat$event=="lud",]
flow.obsdat<-obsdat[obsdat$event=="ffd",]
flow.expdat<-expdat[expdat$event=="ffd",]
leaf.obs.mod<-lmer(doy ~ tmean + (1|site/spgen), data=leaf.obsdat)
summary(leaf.obs.mod)
flow.obs.mod<-lmer(doy ~ tmean + (1|site/spgen), data=flow.obsdat)
summary(flow.obs.mod)
leaf.obs.CI<-confint(flow.obs.mod)
leaf.obs.CI
leaf.obs.CI[,4]
leaf.obs.CI[4,]
leaf.obs.CI[5,2]
flow.obs.CI<-confint(leaf.obs.mod)
leaf.exp.CI<-confint(leaf.exp.mod)
leaf.exp.mod<-lmer(doy ~ tmean + (1|site/spgen), data=leaf.obsdat)
summary(leaf.obs.mod)
flow.exp.mod<-lmer(doy ~ tmean + (1|site/spgen), data=flow.expdat)
summary(flow.obs.mod)
leaf.exp.CI<-confint(leaf.exp.mod)
flow.exp.CI<-confint(flow.exp.mod)
flow.exp.mod<-lmer(doy ~ tmean + (1|site/spgen), data=flow.expdat)
leaf.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=leaf.expdat)
summary(leaf.obs.mod)
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=flow.expdat)
summary(flow.obs.mod)
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=flow.expdat)
summary(flow.exp.mod)
dim(flow.expdat)
flow.expdat<-expdat[expdat$event=="ffd"|expdat$event=="ffrd"|,]
flow.expdat<-expdat[expdat$event=="ffd"|expdat$event=="ffrd",]
flow.expdat<-expdat[expdat$event=="ffd"|expdat$event=="ffrd",]
flow.obsdat<-obsdat[obsdat$event=="ffd"|expdat$event=="ffrd",]
flow.obsdat<-obsdat[obsdat$event=="ffd"|obsdat$event=="ffrd",]
leaf.obs.mod<-lmer(doy ~ tmean + (1|site/spgen), data=leaf.obsdat)
summary(leaf.obs.mod)
flow.obs.mod<-lmer(doy ~ tmean + (1|site/spgen), data=flow.obsdat)
summary(flow.obs.mod)
leaf.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=leaf.expdat)
summary(leaf.obs.mod)
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=flow.expdat)
summary(flow.exp.mod)
head(expclim)
exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=expdat)
leaf.obs.CI<-confint(flow.obs.mod)
flow.obs.CI<-confint(leaf.obs.mod)
leaf.exp.CI<-confint(leaf.exp.mod)
flow.exp.CI<-confint(flow.exp.mod)
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site/spgen), data=flow.expdat)
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1.25,flow.obs.CI[5,1],1.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,leaf.obs.CI[5,1],2.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(.75,flow.exp.CI[5,1],.75,flow.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
flow.obs.CI[5,1]
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
points(1.75),fixef(leaf.exp.mod)[2],type="p", pch=16, cex=1.3,col="darkred")
points(1.75,fixef(leaf.exp.mod)[2],type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1.25,flow.obs.CI[5,1],1.25,flow.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,leaf.obs.CI[5,1],2.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
fixef(leaf.obs.mod)[2]
fixef(flow.obs.mod)[2]
flow.obs.CI[5,1]
flow.obs.CI[5,2]
fixef(flow.obs.mod)
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlim=c(.5,2.5), ylim=c(-7.5,0))
points(1.75,fixef(leaf.exp.mod)[2],type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1.25,leaf.obs.CI[5,1],1.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,flow.obs.CI[5,1],2.25,flow.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|site), data=flow.expdat)
flow.expdat
flow.exp.mod<-lmer(doy ~ soiltemp1_mean + (1|spgen), data=flow.expdat)
summary(flow.exp.mod)
flow.exp.CI<-confint(flow.exp.mod)
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
arrows(.75,flow.exp.CI[5,1],.75,flow.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
flow.exp.CI
arrows(.75,flow.exp.CI[4,1],.75,flow.exp.CI[4,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
mtext("Flowering")
mtext("Flowering", side=1,line=1)
mtext("Flowering", side=1,line=1, adj=0)
mtext("Flowering", side=1,line=1, adj=0.5)
mtext("Flowering", side=1,line=1, adj=0.2)
mtext("Flowering", side=1,line=1, adj=0.25)
mtext("Flowering", side=1,line=1, adj=0.25, cex=1.1)
mtext("Leafing", side=1,line=1, adj=0.75, cex=1.1)
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0))
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0))
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1.25,flow.obs.CI[5,1],1.25,flow.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,leaf.obs.CI[5,1],2.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(.75,flow.exp.CI[4,1],.75,flow.exp.CI[4,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
mtext("Flowering", side=1,line=1, adj=0.25, cex=1.2)
mtext("Leafing", side=1,line=1, adj=0.75, cex=1.2)
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0))
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(.75,flow.exp.CI[4,1],.75,flow.exp.CI[4,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
mtext("Flowering", side=1,line=1, adj=0.25, cex=1.2)
mtext("Leafing", side=1,line=1, adj=0.75, cex=1.2)
arrows(1.25,leaf.obs.CI[5,1],1.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,flow.obs.CI[5,1],2.25,flow.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0), cex.axis=1.5)
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0), cex.lab=1.)
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0), cex.lab=1.5)
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0), cex.lab=1.5, cex.axis=1.2)
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
quartz()
plot(c(1.25,2.25),c(fixef(flow.obs.mod)[2],fixef(leaf.obs.mod)[2]),type="p", pch=22,cex=1.3,col="blue",bty="l",ylab="Sensitivity (change days per C)", xaxt="n", xlab="",xlim=c(.5,2.5), ylim=c(-7.5,0), cex.lab=1.5, cex.axis=1.2)
points(c(.75,1.75),c(fixef(flow.exp.mod)[2],fixef(leaf.exp.mod)[2]),type="p", pch=16, cex=1.3,col="darkred")
legend(.5,-.5,legend=c("Experiments","Observations"), bty="n",pch=c(16,22),col=c("darkred","blue"))
abline(h=0, lty=2, lwd=2, col="gray")
arrows(1.25,leaf.obs.CI[5,1],1.25,leaf.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(2.25,flow.obs.CI[5,1],2.25,flow.obs.CI[5,2],length=.05,angle=90,col="blue",code=3,lwd=2)
arrows(.75,flow.exp.CI[4,1],.75,flow.exp.CI[4,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
arrows(1.75,leaf.exp.CI[5,1],1.75,leaf.exp.CI[5,2],length=.05,angle=90,col="darkred",code=3,lwd=2)
mtext("Flowering", side=1,line=1, adj=0.25, cex=1.2)
mtext("Leafing", side=1,line=1, adj=0.75, cex=1.2)
quartz()
par(mfrow=c(1,2))
hist(expclim$soiltemp1_mean)
hist(obsclim$tmean)
quartz()
par(mfrow=c(1,2))
hist(expclim$soiltemp1_mean, main ="Experiments",xlab="Mean soil temp" )
hist(obsclim$tmean, main="Observations",xlab="MAT")
hist(expclim$soiltemp1_mean)
colnames(expclim)
hist((airtemp_min"+"airtemp_max)/2, main ="Experiments",xlab="Mean air temp")
hist((expclim$airtemp_min+expclim$airtemp_max)/2, main ="Experiments",xlab="Mean air temp")
quartz()
par(mfrow=c(1,3))
hist(expclim$soiltemp1_mean, main ="Experiments",xlab="Mean soil temp" )
hist((expclim$airtemp_min+expclim$airtemp_max)/2, main ="Experiments",xlab="Mean air temp")
hist(obsclim$tmean, main="Observations",xlab="MAT")
quartz()
par(mfrow=c(1,3))
hist(expclim$soiltemp1_mean, main ="Experiments",xlab="Mean soil temp",ylim=c(1,150000))
hist((expclim$airtemp_min+expclim$airtemp_max)/2, main ="Experiments",xlab="Mean air temp",ylim=c(1,150000))
hist(obsclim$tmean, main="Observations",xlab="MAT",ylim=c(1,150000))
quartz()
par(mfrow=c(1,3))
hist(expclim$soiltemp1_mean, main ="Experiments",xlab="Mean soil temp",ylim=c(1,180000))
hist((expclim$airtemp_min+expclim$airtemp_max)/2, main ="Experiments",xlab="Mean air temp",ylim=c(1,180000))
hist(obsclim$tmean, main="Observations",xlab="MAT",ylim=c(1,180000))
quartz()
par(mfrow=c(1,3))
hist(expclim$soiltemp1_mean, main ="Experiments",xlab="Mean soil temp",ylim=c(1,180000))
hist((expclim$airtemp_min+expclim$airtemp_max)/2, main ="Experiments",xlab="Mean air temp",ylim=c(1,180000))
hist(obsclim$tmean, main="Observations",xlab="Mean annual temp",ylim=c(1,180000))
%%% start preambling . . .  %%%
\documentclass{article}
% required
\usepackage{Sweave}
\usepackage{graphicx}
head(exppheno)
head(obsdata)
head(obspheno)
unique(obsphen$plot)
unique(obspheno$plot)
getwd()
quartz()
par(mfrow=c(1,3))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,180000))
histflow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,180000))
histflow.obsdat$doy, main="Observations",xlab="Flowering DOY,ylim=c(1,180000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY,ylim=c(1,180000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,180000))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,180000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,180000))
quartz()
par(mfrow=c(1,3))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,180000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,180000))
quartz()
par(mfrow=c(1,3))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,50000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,50000))
quartz()
par(mfrow=c(1,2))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,50000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,50000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,50000))
hist(leaf.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,50000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,50000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,50000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,1000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,1000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,2000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,2000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,4000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,4000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,5000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,5000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,6000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,6000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,7000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,7000))
quartz()
par(mfrow=c(1,2))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,50000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,50000))
quartz()
par(mfrow=c(1,2))
hist(leaf.expdat$doy, main ="Experiments",xlab="Leafing DOY",ylim=c(1,7000))
hist(leaf.obsdat$doy, main="Observations",xlab="Leafing DOY",ylim=c(1,7000))
quartz()
par(mfrow=c(1,2))
hist(flow.expdat$doy, main ="Experiments",xlab="Flowering DOY",ylim=c(1,50000))
hist(flow.obsdat$doy, main="Observations",xlab="Flowering DOY",ylim=c(1,50000))
getwd()
head(exppheno)
library(tools)
library(xtable)
options(SweaveSyntax="SweaveSyntaxNoweb")
install.packages("stable")
install.packages("xtable")
install.packages("tools")
install.packages("tools")
install.packages("tools")
library(tools)
library(xtable)
options(SweaveSyntax="SweaveSyntaxNoweb")
\documentclass{article}
setwd("/Users/aileneettinger/GitHub/radcliffe/sweave")
obsdata <- read.csv("radmeeting/obspheno.csv", header=TRUE)
expdata <- read.csv("radmeeting/exppheno.csv", header=TRUE)
list.dirs()
setwd("~/Users/aileneettinger/GitHub/radcliffe")
getwd()
setwd("~/Users/aileneettinger/GitHub/radcliffe")
